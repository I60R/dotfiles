### Global variables

set $Mod Mod4
set $CapsLock 66

set $font pango:Iosevka, Heavy 9




### Keyboard configuration

set $keyboard  input type:keyboard
set $xkbopt    "caps:none,shift:both_capslock,altwin:swap_alt_win,compose:ralt"
set $xkbopt_pl "caps:none,shift:both_capslock,altwin:swap_alt_win,lv3:ralt_switch_multikey"

$keyboard xkb_options $xkbopt
$keyboard xkb_numlock disabled

bindcode Ctrl+Shift+$CapsLock  $keyboard xkb_layout ua; $keyboard xkb_options $xkbopt xkb_numlock disabled
bindcode      Shift+$CapsLock  $keyboard xkb_layout ru; $keyboard xkb_options $xkbopt xkb_numlock disabled
bindcode       Ctrl+$CapsLock  $keyboard xkb_layout pl; $keyboard xkb_options $xkbopt_pl xkb_numlock disabled
bindcode            $CapsLock  $keyboard xkb_layout us; $keyboard xkb_options $xkbopt xkb_numlock disabled




### Pointer configuration
focus_wrapping no
input type:touchpad {
    tap enabled
}




### Auto(re)start

exec_always killall ~/.config/sway/autostart.sh
exec_always ~/.config/sway/autostart.sh




### Output configuration

set $primary LVDS-0
output $primary max_render_time 5
output $primary subpixel rgb
seat seat0 xcursor_theme Fuchsia 22




### Modify windows

for_window [app_id="fmit"]               fullscreen enable
for_window [class="vlc"]                 floating enable
for_window [app_id="org.twosheds.iwgtk"] floating enable
for_window [title="Copying.*Krusader"]   floating enable
for_window [title="Moving.*Krusader"]    floating enable
for_window [app_id="iwgtk"]              floating enable
for_window [app_id="guitarix"]           floating enable
for_window [app_id="albert"]             floating enable; move up 200 px




### Misc options

set $focus_color #223249
set $inact_color #00000000
set $label_color #CCCCCC

client.focused   $focus_color $focus_color $label_color $focus_color $focus_color
client.unfocused $inact_color $inact_color $label_color $inact_color $inact_color

default_border pixel 3
default_floating_border pixel 3
gaps inner 6
gaps outer 3

workspace number 1

floating_modifier $Mod normal

font $font




### Launcher key bindings:

# Start a terminal

#set $term_args --working-directory="$(swaycwd)" -e nvim term://zsh --cmd 'au TermOpen * ++once normal a'
# set $term alacritty msg create-window $term_args || alacritty $term_args


bindsym $Mod+Return exec neovide term://zsh


# Start an empty workspace
bindsym $Mod+Shift_R exec ~/.config/sway/wsempty.py


# Start a browser
# urlencode from https://stackoverflow.com/a/34407620/6186709
set $search firefox --new-tab https://google.com/search?q=$(wl-clip -o | jq -Rr @uri)
bindsym XF86HomePage exec $search
no_focus   [app_id="firefox" title="Picture-in-Picture"]
for_window [app_id="firefox" title="Picture-in-Picture"] floating enable; move position 66 ppt 66 ppt; resize set width 30 ppt; resize set height 30 ppt; sticky enable; opacity 0.7
no_focus   [app_id="firefox" title="Firefox — Sharing Indicator"]
for_window [app_id="firefox" title="Firefox — Sharing Indicator"] floating enable; move down 450 px; sticky enable
for_window [app_id="firefox" title="Mozilla Firefox \(Private Browsing\)"] move container to workspace number 9; workspace number 9


# Start a calculator
bindsym XF86Calculator exec gnome-calculator
for_window [app_id="org.gnome.Calculator"] floating enable


# Start launcher
bindsym $Mod+Menu exec albert toggle


# Start galery app
bindsym $Mod+Shift+Menu exec gthumb


# Start file manager
bindsym $Mod+Ctrl+Menu exec krusader


# Start office
bindsym $Mod+Multi_key+Menu exec libreoffice


# Start media player
bindsym $Mod+Ctrl+Shift+Menu exec vlc


# Start favorite text editor
bindsym $Mod+Alt+Menu exec code


# Start screen recording
bindsym $Mod+Ctrl+Shift+Insert exec obs


# Start screenshot

bindsym $Mod+Insert exec ~/.config/sway/screenshot.sh


# Start color picker

bindsym $Mod+Shift+Insert exec wl-copy $(hyprpicker)


# Start sound config
bindsym KP_Enter workspace number 8; exec helvum; exec pavucontrol; exec easyeffects;
for_window [app_id="pavucontrol"]                 move container to workspace number 8; workspace number 8; resize shrink width 300 px; splitv
for_window [app_id="org.pipewire.Helvum"]         move container to workspace number 8; workspace number 8
for_window [app_id="com.github.wwmm.easyeffects"] move container to workspace number 8; workspace number 8

# Start system monitor
bindsym KP_Multiply exec gnome-system-monitor
for_window [app_id="gnome-system-monitor"] fullscreen enable

# Start keylogger
bindsym       $Mod+Ctrl+Space exec wshowkeys -a left -a bottom
bindsym $Mod+Shift+Ctrl+Space exec killall wshowkeys






### Basic key bindings:

# Lock screen
bindcode $Mod+66 exec ~/.config/sway/screenlock-instant.sh


# Kill focused window
bindsym $Mod+c kill
# Prevent this binding from killing windows
bindsym Ctrl+q exec


# Reload the configuration file
bindsym $Mod+Ctrl+r reload


# Exit sway (logs you out of your wayland session)
bindsym $Mod+Ctrl+q exit




### Notification key bindings:

bindsym $Mod+n            exec dunstctl close
bindsym $Mod+Ctrl+n       exec dunstctl close-all
bindsym $Mod+Shift+n      exec dunstctl history-pop
bindsym $Mod+Ctrl+Shift+n exec dunstctl action




### Moving around key bindings:

# Move focus around
bindsym $Mod+h focus left
bindsym $Mod+j focus down
bindsym $Mod+k focus up
bindsym $Mod+l focus right

# Cycle through windows
bindsym $Mod+Tab       focus next
bindsym $Mod+Shift+Tab focus prev

# Move the focused window through workspace
bindsym $Mod+Shift+h move left
bindsym $Mod+Shift+j move down
bindsym $Mod+Shift+k move up
bindsym $Mod+Shift+l move right




### Workspace key bindings:

# Toggle workspace
bindsym $Mod+grave workspace back_and_forth

# Switch to workspace
bindsym --no-repeat $Mod+1 workspace number 1; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+2 workspace number 2; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+3 workspace number 3; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+4 workspace number 4; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+5 workspace number 5; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+6 workspace number 6; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+7 workspace number 7; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+8 workspace number 8; exec "echo 1 > /tmp/sovpipe"
bindsym --no-repeat $Mod+9 workspace number 9; exec "echo 1 > /tmp/sovpipe"

bindsym --release $Mod+1 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+2 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+3 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+4 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+5 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+6 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+7 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+8 exec "echo 0 > /tmp/sovpipe"
bindsym --release $Mod+9 exec "echo 0 > /tmp/sovpipe"

# Move focused container to workspace
bindsym $Mod+Shift+1 move container to workspace number 1
bindsym $Mod+Shift+2 move container to workspace number 2
bindsym $Mod+Shift+3 move container to workspace number 3
bindsym $Mod+Shift+4 move container to workspace number 4
bindsym $Mod+Shift+5 move container to workspace number 5
bindsym $Mod+Shift+6 move container to workspace number 6
bindsym $Mod+Shift+7 move container to workspace number 7
bindsym $Mod+Shift+8 move container to workspace number 8
bindsym $Mod+Shift+9 move container to workspace number 9

bindsym $Mod+Shift+BackSpace workspace next
bindsym       $Mod+BackSpace workspace prev




### Layout key bindings:

# Split the current object of your focus
bindsym $Mod+bar splith
bindsym $Mod+minus splitv

# Switch the current container between different layout styles
bindsym $Mod+s layout stacking
bindsym $Mod+t layout tabbed
bindsym $Mod+Escape layout toggle split

# Make the current focus fullscreen:
bindsym $Mod+f fullscreen

# Toggle the current focus between tiling and floating mode
bindsym $Mod+Shift+w floating toggle

# Swap focus between the tiling area and the floating area
bindsym $Mod+w focus mode_toggle


# Move the currently focused window to the scratchpad
bindsym $Mod+Shift+0 move scratchpad

# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
bindsym $Mod+0 scratchpad show




### Media key bindings:

# Logout menu
bindsym XF86PowerOff exec wlogout

# Volume control
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym Home          exec pactl set-sink-volume @DEFAULT_SINK@ +2%; exec pactl set-sink-mute @DEFAULT_SINK@ 0
bindsym End           exec pactl set-sink-volume @DEFAULT_SINK@ -2%; exec pactl set-sink-mute @DEFAULT_SINK@ 0

# Backlight control
bindsym Prior exec echo $(($(cat /sys/class/backlight/nv_backlight/brightness) + 2)) > /sys/class/backlight/nv_backlight/brightness
bindsym Next  exec echo $(($(cat /sys/class/backlight/nv_backlight/brightness) - 2)) > /sys/class/backlight/nv_backlight/brightness

set $ctrl  29:1
set $shift 42:1
set $alt   56:1

bindsym       KP_Delete exec ydotool key        $ctrl 15:1 15:0 29:0      #tab
bindsym Shift+KP_Delete exec ydotool key $ctrl $shift 15:1 15:0 29:0 42:0

bindsym       KP_Insert exec ydotool key        $ctrl 17:1 17:0 29:0      #w
bindsym Shift+KP_Insert exec ydotool key $ctrl $shift 20:1 20:0 29:0 42:0 #t

bindsym KP_Begin exec ydotool     key 106:1 106:0 #KEY_RIGHT
bindsym KP_Right exec ydotool     key 158:1 158:0 #KEY_BACK

bindcode    Shift+94 exec ydotool key 159:1 159:0 #KEY_FORWARD

bindcode          94 exec ydotool key            $shift+7:1 7:0 42:0 #6
bindcode     Ctrl+94 exec ydotool key      $ctrl+$shift+7:1 7:0 42:0 29:0
bindcode Ctrl+Alt+94 exec ydotool key $ctrl+$alt+$shift+7:1 7:0 42:0 29:0
bindcode      Alt+94 exec ydotool key       $alt+$shift+7:1 7:0 42:0 56:0





### Modes:

bindsym $Mod+r mode "RESIZE"
mode "RESIZE" {
    # Shrink/grow the containers width/height
    bindsym h resize shrink width  10 px or 10 ppt
    bindsym j resize grow   height 10 px or 10 ppt
    bindsym k resize shrink height 10 px or 10 ppt
    bindsym l resize grow   width  10 px or 10 ppt

    # return to default mode
    bindsym $Mod+r mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $Mod+g mode "GAPS"
mode "GAPS" {
    # Shrink/grow the containers inner/outer gaps
    bindsym h gaps inner current minus 10
    bindsym j gaps outer current plus  10
    bindsym k gaps outer current minus 10
    bindsym l gaps inner current plus  10

    # reset to default
    bindsym 0 gaps inner current set 1; gaps outer current set 1
    bindsym 1 gaps inner current set 1

    # return to default mode
    bindsym $Mod+g mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $Mod+o mode "OPACITY"
bindsym $Mod+Shift+o mark --toggle "opaque"
mode "OPACITY" {
    bindsym j opacity minus 0.3
    bindsym k opacity plus 0.3

    # reset to default
    bindsym 0 opacity 1
    bindsym 1 opacity 0

    # return to default mode
    bindsym $Mod+o mode "default"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $Mod+Space mode "NAVIGATION"
mode "NAVIGATION" {
    bindsym                 h exec ydotool key Left
    bindsym                 j exec ydotool key Down
    bindsym                 k exec ydotool key Up
    bindsym                 l exec ydotool key Right

    bindsym            $Mod+h exec ydotool key Left
    bindsym            $Mod+j exec ydotool key Down
    bindsym            $Mod+k exec ydotool key Up
    bindsym            $Mod+l exec ydotool key Right

    bindsym      $Mod+Shift+h exec ydotool key Shift+Ctrl+Left
    bindsym      $Mod+Shift+j exec ydotool key Shift+Ctrl+Down
    bindsym      $Mod+Shift+k exec ydotool key Shift+Ctrl+Up
    bindsym      $Mod+Shift+l exec ydotool key Shift+Ctrl+Right

    bindsym $Mod+Shift+Ctrl+h exec ydotool key Shift+Left
    bindsym $Mod+Shift+Ctrl+j exec ydotool key Shift+Down
    bindsym $Mod+Shift+Ctrl+k exec ydotool key Shift+Up
    bindsym $Mod+Shift+Ctrl+l exec ydotool key Shift+Right

    bindsym b exec ydotool key Ctrl+Left
    bindsym e exec ydotool key Ctrl+Right

    bindsym w exec ydotool key       Ctrl+Tab
    bindsym s exec ydotool key Ctrl+Shift+Tab

    bindsym a exec ydotool key Alt+Left
    bindsym q exec ydotool key Alt+Right

    bindsym g exec ydotool key Ctrl  --down
    bindsym v exec ydotool key Shift --down

    bindsym d exec ydotool key Ctrl+w
    bindsym x exec ydotool key Ctrl+x
    bindsym y exec ydotool key Ctrl+c
    bindsym p exec ydotool key Ctrl+v

    bindsym u exec ydotool key Up   --repeat 10 --repeat-delay 0
    bindsym n exec ydotool key Down --repeat 10 --repeat-delay 0

    bindsym Shift+h exec ydotool key Ctrl+Home
    bindsym Shift+j exec ydotool key PageDown
    bindsym Shift+k exec ydotool key PageUp
    bindsym Shift+l exec ydotool key Ctrl+End

    # return to default mode
    bindsym $Mod+Space exec ydotool key Shift --up key Ctrl --up; mode "default"
    bindsym i          exec ydotool key Shift --up key Ctrl --up; mode "default"
    bindsym Return     exec ydotool key Shift --up key Ctrl --up; mode "default"
    bindsym Escape     exec ydotool key Shift --up key Ctrl --up; mode "default"
}




### Status

# Top
bar {
    font $font
    position top
    gaps 4 0 0 4
    height 26
    status_command i3status-rs ~/.config/i3status-rust/top-config.toml
    separator_symbol ""
    workspace_buttons no
    binding_mode_indicator no
    tray_output $primary
    tray_padding 3
    tray_bindsym button1 Activate
    tray_bindsym button2 SecondaryActivate
    tray_bindsym button3 ContextMenu

    colors {
        background #00000000
        focused_background #00000000
        active_workspace #53326D #53326D #FFFFFF
        focused_workspace #53326D #53326D #FFFFFF
        inactive_workspace #00000000 #00000000 #FFFFFF
    }
}

# Bottom
bar {
    font $font
    position bottom
    gaps 4 0 0 4
    height 26
    strip_workspace_name no
    strip_workspace_numbers no
    status_command i3status-rs ~/.config/i3status-rust/bottom-config.toml
    separator_symbol ""

    colors {
        background #00000000
        focused_background #00000000
        active_workspace #53326D #53326D #FFFFFF
        focused_workspace #53326D #53326D #FFFFFF
        inactive_workspace #00000000 #00000000 #FFFFFF
    }
}

